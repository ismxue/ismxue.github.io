<!DOCTYPE HTML>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="Deep Learning with PyTorch-note, It&#39;s the job that&#39;s never started as takes longest to finish.”― J.R.R. Tolkien">
    <meta name="baidu-site-verification" content="fmlEuI34ir">
    <meta name="google-site-verification" content="yCy2azpds5XSuGZvis6OuA-XIGF5GuGpYRAaGfD6o48">
    <meta name="360-site-verification" content="b7c11a830ef90fd1464ad6206bb7b6e7">
    <meta name="description" content="
Youtube Video
Blog PostDeepLizard 中文笔记

8. PyTorch Tensors Explained - Neural Network Programming
9. Creating PyTorch T">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Deep Learning with PyTorch-note | M&#39;s Blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
    <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?46e79e71af0709a5b9106bf20cecc493";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

    
        <script>
            (function(){
                var bp = document.createElement('script');
                var curProtocol = window.location.protocol.split(':')[0];
                if (curProtocol === 'https') {
                    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
                }
                else {
                    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                }
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(bp, s);
            })();
        </script>
    

    <script>
        (function(){
        var src = "https://jspassport.ssl.qhimg.com/11.0.1.js?d182b3f28525f2db83acfaaf6e696dba";
        document.write('<script src="' + src + '" id="sozz"><\/script>');
        })();
    </script>

<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body>

    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">M's Blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>标签</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>关于</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>友情链接</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/lifelog" class="waves-effect waves-light">
            
            <i class="fa fa-comments"></i>
            
            <span>Life Log</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">M's Blog</div>
        <div class="logo-desc">
            
            Growth | Study
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                标签
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                关于
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                友情链接
            </a>
        </li>
        
        <li>
            <a href="/lifelog" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-comments"></i>
                
                Life Log
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/ismxue" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/ismxue" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/28.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        Deep Learning with PyTorch-note
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                        <a href="/tags/深度学习/" target="_blank">
                            <span class="chip bg-color">深度学习</span>
                        </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                        <a href="/categories/Python/" class="post-category" target="_blank">
                            Python
                        </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-11-01
                </div>

                <div class="post-author info-break-policy">
                    <i class="fa fa-user-o fa-fw"></i>作者:&nbsp;&nbsp;
                    
                    M
                    
                </div>

                
                
                <div class="info-break-policy">
                    <i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp;
                    1.6k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    9 分
                </div>
                
                

                
                <div id="busuanzi_container_page_pv" class="info-break-policy">
                    <i class="fa fa-eye fa-fw"></i>热度:&nbsp;&nbsp;
                    <span id="busuanzi_value_page_pv"></span>
                </div>
                
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <blockquote>
<p><a href="https://www.youtube.com/watch?v=v5cngxo4mIg&list=PLZbbT5o_s2xrfNyHZsM6ufI0iZENK9xgG&index=1" target="_blank" rel="noopener">Youtube Video</a></p>
<p><a href="https://deeplizard.com/learn/video/v5cngxo4mIg" target="_blank" rel="noopener">Blog Post</a><br><a href="https://github.com/wanyueli/DeepLizard-pytorch-" target="_blank" rel="noopener">DeepLizard 中文笔记</a></p>
</blockquote>
<h1 id="8-PyTorch-Tensors-Explained-Neural-Network-Programming"><a href="#8-PyTorch-Tensors-Explained-Neural-Network-Programming" class="headerlink" title="8. PyTorch Tensors Explained - Neural Network Programming"></a>8. PyTorch Tensors Explained - Neural Network Programming</h1><p><img src="https://i.loli.net/2020/10/29/iDBuEPZH49t5fU8.png" alt></p>
<h1 id="9-Creating-PyTorch-Tensors-for-Deep-Learning-Best-Options"><a href="#9-Creating-PyTorch-Tensors-for-Deep-Learning-Best-Options" class="headerlink" title="9. Creating PyTorch Tensors for Deep Learning - Best Options"></a>9. Creating PyTorch Tensors for Deep Learning - Best Options</h1><p><img src="https://i.loli.net/2020/10/29/4wRlmHfgWB2aGIC.png" alt><br><img src="https://i.loli.net/2020/10/29/IZ9c25SXDewjVva.png" alt></p>
<h1 id="10-Flatten-Reshape-and-Squeeze-Explained"><a href="#10-Flatten-Reshape-and-Squeeze-Explained" class="headerlink" title="10. Flatten, Reshape, and Squeeze Explained"></a>10. Flatten, Reshape, and Squeeze Explained</h1><p><img src="https://i.loli.net/2020/10/29/dRGPOCAngyQp46U.png" alt></p>
<h1 id="11-CNN-Flatten-Operation-Visualized-Tensor-Batch-Processing-for-Deep-Learning"><a href="#11-CNN-Flatten-Operation-Visualized-Tensor-Batch-Processing-for-Deep-Learning" class="headerlink" title="11. CNN Flatten Operation Visualized - Tensor Batch Processing for Deep Learning"></a>11. CNN Flatten Operation Visualized - Tensor Batch Processing for Deep Learning</h1><ul>
<li>Flattening Specific Axes Of A Tensor</li>
</ul>
<p>In the post on CNN input tensor shape, we learned how tensor inputs to a convolutional neural network typically have 4 axes, one for batch size, one for color channels, and one each for height and width.</p>
<p>Notice in the call how we specified the <code>start_dim</code> parameter. This tells the <code>flatten()</code> method which axis it should start the flatten operation. The one here is an index, so it’s the second axis which is the color channel axis. We skip over the batch axis so to speak, leaving it intact.</p>
<h1 id="19-CNN-Weights-Learnable-Parameters-in-PyTorch-Neural-Networks"><a href="#19-CNN-Weights-Learnable-Parameters-in-PyTorch-Neural-Networks" class="headerlink" title="19. CNN Weights - Learnable Parameters in PyTorch Neural Networks"></a>19. CNN Weights - Learnable Parameters in PyTorch Neural Networks</h1><p><img src="https://i.loli.net/2020/11/09/L9DIuYM1ckrdUqp.png" alt></p>
<ul>
<li>input is 4-dimension, output is 3-dimension, the shape of weight is 3*4.</li>
</ul>
<p><img src="https://i.loli.net/2020/11/09/pmF53SiU7v9TDMt.png" alt><br><img src="https://i.loli.net/2020/11/09/QL1K9GgezrqByin.png" alt></p>
<h1 id="25-CNN-Output-Size-Formula-Bonus-Neural-Network-Debugging-Session"><a href="#25-CNN-Output-Size-Formula-Bonus-Neural-Network-Debugging-Session" class="headerlink" title="25. CNN Output Size Formula - Bonus Neural Network Debugging Session"></a>25. CNN Output Size Formula - Bonus Neural Network Debugging Session</h1><p><img src="https://i.loli.net/2020/11/10/LN8oVtwf6vga1YA.png" alt></p>
<h1 id="26-CNN-Training-with-Code-Example-Neural-Network-Programming-Course"><a href="#26-CNN-Training-with-Code-Example-Neural-Network-Programming-Course" class="headerlink" title="26. CNN Training with Code Example - Neural Network Programming Course"></a>26. CNN Training with Code Example - Neural Network Programming Course</h1><ul>
<li>Training Using a Single Batch<ul>
<li>Calculate Loss</li>
<li>Calculate Gradients</li>
<li>Update Weight</li>
</ul>
</li>
</ul>
<p><img src="https://i.loli.net/2020/11/10/z6RDKBotrWMHhkP.png" alt></p>
<h1 id="27-CNN-Training-Loop-Explained-Neural-Network-Code-Project"><a href="#27-CNN-Training-Loop-Explained-Neural-Network-Code-Project" class="headerlink" title="27. CNN Training Loop Explained - Neural Network Code Project"></a><a href="https://deeplizard.com/learn/video/XfYmia3q2Ow" target="_blank" rel="noopener">27. CNN Training Loop Explained - Neural Network Code Project</a></h1><blockquote>
<p>well explained what happened with each loop.</p>
</blockquote>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> torch
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> F
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">as</span> optim

<span class="token keyword">import</span> torchvision
<span class="token keyword">import</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">as</span> transforms

torch<span class="token punctuation">.</span>set_printoptions<span class="token punctuation">(</span>linewidth<span class="token operator">=</span><span class="token number">120</span><span class="token punctuation">)</span>
torch<span class="token punctuation">.</span>set_grad_enabled<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">get_num_correct</span><span class="token punctuation">(</span>preds<span class="token punctuation">,</span>labels<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> preds<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>eq<span class="token punctuation">(</span>labels<span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Network</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        super<span class="token punctuation">(</span>Network<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment" spellcheck="true"># 维度计算公式：output=(n-filter+2padding)/stride+1。因此：</span>
        <span class="token comment" spellcheck="true"># 原始图片大小：28*28</span>
        <span class="token comment" spellcheck="true"># conv1后，28-5+1=24。当前图片大小：24*24</span>
        <span class="token comment" spellcheck="true"># max_pool2d后，（24-2）/2+1=12。当前图片大小：12*12</span>
        <span class="token comment" spellcheck="true"># conv2后，12-5+1=8。当前图片大小：8*8</span>
        <span class="token comment" spellcheck="true"># max_pool2后，（8-2）/2+1=4。当前图片大小：4*4。当前这张图片有12g个channels</span>
        <span class="token comment" spellcheck="true"># 此时，这张图片的维度为1*12*4*4（batch*channel*heigtht*width）。在进fc1时，把这张图片转为（1行，12*4*4列）维度</span>

        self<span class="token punctuation">.</span>conv1<span class="token operator">=</span>nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>out_channels<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span>kernel_size<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>conv2<span class="token operator">=</span>nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span>out_channels<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>kernel_size<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>fc1<span class="token operator">=</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>in_features<span class="token operator">=</span><span class="token number">12</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">,</span>out_features<span class="token operator">=</span><span class="token number">120</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>fc2<span class="token operator">=</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>in_features<span class="token operator">=</span><span class="token number">120</span><span class="token punctuation">,</span>out_features<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>out<span class="token operator">=</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>in_features<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">,</span>out_features<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 有10种输出类型</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">:</span>
        t<span class="token operator">=</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv1<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token operator">=</span>F<span class="token punctuation">.</span>max_pool2d<span class="token punctuation">(</span>t<span class="token punctuation">,</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
        t<span class="token operator">=</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv2<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>
        t<span class="token operator">=</span>F<span class="token punctuation">.</span>max_pool2d<span class="token punctuation">(</span>t<span class="token punctuation">,</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>

        t<span class="token operator">=</span>t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span>
        t<span class="token operator">=</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc1<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>
        t<span class="token operator">=</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc2<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>
        t<span class="token operator">=</span>self<span class="token punctuation">.</span>out<span class="token punctuation">(</span>t<span class="token punctuation">)</span>
        <span class="token keyword">return</span> t

train_set<span class="token operator">=</span>torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>FashionMNIST<span class="token punctuation">(</span>
    root<span class="token operator">=</span><span class="token string">'./data'</span><span class="token punctuation">,</span>
    train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    transform<span class="token operator">=</span>transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>
        transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

network<span class="token operator">=</span>Network<span class="token punctuation">(</span><span class="token punctuation">)</span>
train_loader<span class="token operator">=</span>torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>train_set<span class="token punctuation">,</span>batch_size<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
optimizer<span class="token operator">=</span>optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>network<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> epoch <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># epoch表示完整的一批数据</span>
    total_loss <span class="token operator">=</span> <span class="token number">0</span>
    total_correct <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> batch <span class="token keyword">in</span> train_loader<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># batch表示某epoch中的一部分数据</span>
        images<span class="token punctuation">,</span>labels<span class="token operator">=</span>batch
        preds<span class="token operator">=</span>network<span class="token punctuation">(</span>images<span class="token punctuation">)</span>
        loss<span class="token operator">=</span>F<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">(</span>preds<span class="token punctuation">,</span>labels<span class="token punctuation">)</span>

        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>

        total_loss<span class="token operator">+=</span>loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
        total_correct<span class="token operator">+=</span>get_num_correct<span class="token punctuation">(</span>preds<span class="token punctuation">,</span>labels<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"epoch: "</span><span class="token punctuation">,</span>epoch<span class="token punctuation">,</span>
          <span class="token string">"total_loss: "</span><span class="token punctuation">,</span>total_loss<span class="token punctuation">,</span>
          <span class="token string">"total_correct: "</span><span class="token punctuation">,</span>total_correct<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>total_correct<span class="token operator">/</span>len<span class="token punctuation">(</span>train_set<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># epoch:  0 total_loss:  358.2741909921169 total_correct:  46523</span>
<span class="token comment" spellcheck="true"># epoch:  1 total_loss:  237.37768299877644 total_correct:  51164</span>
<span class="token comment" spellcheck="true"># epoch:  2 total_loss:  216.7216858714819 total_correct:  51954</span>
<span class="token comment" spellcheck="true"># epoch:  3 total_loss:  206.57599268853664 total_correct:  52318</span>
<span class="token comment" spellcheck="true"># epoch:  4 total_loss:  200.8457220196724 total_correct:  52480</span>
<span class="token comment" spellcheck="true"># 0.8746666666666667</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="29-Stack-vs-Concat-in-PyTorch-TensorFlow-amp-NumPy-Deep-Learning-Tensor-Ops"><a href="#29-Stack-vs-Concat-in-PyTorch-TensorFlow-amp-NumPy-Deep-Learning-Tensor-Ops" class="headerlink" title="29. Stack vs Concat in PyTorch, TensorFlow &amp; NumPy - Deep Learning Tensor Ops"></a>29. Stack vs Concat in PyTorch, TensorFlow &amp; NumPy - Deep Learning Tensor Ops</h1><p><img src="https://i.loli.net/2020/11/11/N8KyWxQEvSdz9oj.png" alt></p>
<p><img src="https://i.loli.net/2020/11/11/yhHBitcz6aX7uJ8.png" alt></p>
<p><img src="https://i.loli.net/2020/11/11/vOwo3nzR798VqjL.png" alt></p>
<p><img src="https://s2.loli.net/2022/02/12/Xvx53i9dVcypeWP.png" alt></p>
<p><img src="https://s2.loli.net/2022/02/12/31nl5cDMV6bLidy.png" alt></p>
<p><img src="https://s2.loli.net/2022/02/12/qIujrwK7BhitsbS.png" alt="20220212220317"><br><img src="https://s2.loli.net/2022/02/12/KqNzjrLJDagbWhC.png" alt="20220212220400"></p>
<h1 id="30-TensorBoard-with-PyTorch-Visualize-Deep-Learning-Metrics"><a href="#30-TensorBoard-with-PyTorch-Visualize-Deep-Learning-Metrics" class="headerlink" title="30. TensorBoard with PyTorch - Visualize Deep Learning Metrics"></a>30. TensorBoard with PyTorch - Visualize Deep Learning Metrics</h1><p>完整代码：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> torch
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> F
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">as</span> optim
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>tensorboard <span class="token keyword">import</span> SummaryWriter
<span class="token keyword">import</span> torchvision
<span class="token keyword">import</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">as</span> transforms


torch<span class="token punctuation">.</span>set_printoptions<span class="token punctuation">(</span>linewidth<span class="token operator">=</span><span class="token number">120</span><span class="token punctuation">)</span>
torch<span class="token punctuation">.</span>set_grad_enabled<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">get_num_correct</span><span class="token punctuation">(</span>preds<span class="token punctuation">,</span>labels<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> preds<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>eq<span class="token punctuation">(</span>labels<span class="token punctuation">)</span><span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Network</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        super<span class="token punctuation">(</span>Network<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment" spellcheck="true"># 维度计算公式：output=(n-filter+2padding)/stride+1。因此：</span>
        <span class="token comment" spellcheck="true"># 原始图片大小：28*28</span>
        <span class="token comment" spellcheck="true"># conv1后，28-5+1=24。当前图片大小：24*24</span>
        <span class="token comment" spellcheck="true"># max_pool2d后，（24-2）/2+1=12。当前图片大小：12*12</span>
        <span class="token comment" spellcheck="true"># conv2后，12-5+1=8。当前图片大小：8*8</span>
        <span class="token comment" spellcheck="true"># max_pool2后，（8-2）/2+1=4。当前图片大小：4*4。当前这张图片有12g个channels</span>
        <span class="token comment" spellcheck="true"># 此时，这张图片的维度为1*12*4*4（batch*channel*heigtht*width）。在进fc1时，把这张图片转为（1行，12*4*4列）维度</span>

        self<span class="token punctuation">.</span>conv1<span class="token operator">=</span>nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>out_channels<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span>kernel_size<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>conv2<span class="token operator">=</span>nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span>out_channels<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>kernel_size<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>fc1<span class="token operator">=</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>in_features<span class="token operator">=</span><span class="token number">12</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">,</span>out_features<span class="token operator">=</span><span class="token number">120</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>fc2<span class="token operator">=</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>in_features<span class="token operator">=</span><span class="token number">120</span><span class="token punctuation">,</span>out_features<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>out<span class="token operator">=</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>in_features<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">,</span>out_features<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 有10种输出类型</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">:</span>
        t<span class="token operator">=</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv1<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token operator">=</span>F<span class="token punctuation">.</span>max_pool2d<span class="token punctuation">(</span>t<span class="token punctuation">,</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
        t<span class="token operator">=</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv2<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>
        t<span class="token operator">=</span>F<span class="token punctuation">.</span>max_pool2d<span class="token punctuation">(</span>t<span class="token punctuation">,</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>

        t<span class="token operator">=</span>t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span>
        t<span class="token operator">=</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc1<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>
        t<span class="token operator">=</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc2<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>
        t<span class="token operator">=</span>self<span class="token punctuation">.</span>out<span class="token punctuation">(</span>t<span class="token punctuation">)</span>
        <span class="token keyword">return</span> t

train_set<span class="token operator">=</span>torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>FashionMNIST<span class="token punctuation">(</span>
    root<span class="token operator">=</span><span class="token string">'./data'</span><span class="token punctuation">,</span>
    train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    transform<span class="token operator">=</span>transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>
        transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

network<span class="token operator">=</span>Network<span class="token punctuation">(</span><span class="token punctuation">)</span>
train_loader<span class="token operator">=</span>torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>train_set<span class="token punctuation">,</span>batch_size<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
optimizer<span class="token operator">=</span>optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>network<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span>

images<span class="token punctuation">,</span>labels<span class="token operator">=</span>next<span class="token punctuation">(</span>iter<span class="token punctuation">(</span>train_loader<span class="token punctuation">)</span><span class="token punctuation">)</span>
grid<span class="token operator">=</span>torchvision<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>make_grid<span class="token punctuation">(</span>images<span class="token punctuation">)</span>

tb <span class="token operator">=</span> SummaryWriter<span class="token punctuation">(</span><span class="token punctuation">)</span>
tb<span class="token punctuation">.</span>add_image<span class="token punctuation">(</span><span class="token string">'images'</span><span class="token punctuation">,</span>grid<span class="token punctuation">)</span>
tb<span class="token punctuation">.</span>add_graph<span class="token punctuation">(</span>network<span class="token punctuation">,</span>images<span class="token punctuation">)</span>

<span class="token keyword">for</span> epoch <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># epoch表示完整的一批数据</span>
    total_loss <span class="token operator">=</span> <span class="token number">0</span>
    total_correct <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> batch <span class="token keyword">in</span> train_loader<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># batch表示某epoch中的一部分数据</span>
        images<span class="token punctuation">,</span>labels<span class="token operator">=</span>batch
        preds<span class="token operator">=</span>network<span class="token punctuation">(</span>images<span class="token punctuation">)</span>
        loss<span class="token operator">=</span>F<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">(</span>preds<span class="token punctuation">,</span>labels<span class="token punctuation">)</span>

        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># calculate gradients</span>
        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># update weights</span>

        total_loss<span class="token operator">+=</span>loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
        total_correct<span class="token operator">+=</span>get_num_correct<span class="token punctuation">(</span>preds<span class="token punctuation">,</span>labels<span class="token punctuation">)</span>

    tb<span class="token punctuation">.</span>add_scalar<span class="token punctuation">(</span><span class="token string">'Loss'</span><span class="token punctuation">,</span>total_loss<span class="token punctuation">,</span>epoch<span class="token punctuation">)</span>
    tb<span class="token punctuation">.</span>add_scalar<span class="token punctuation">(</span><span class="token string">'Number Correct'</span><span class="token punctuation">,</span>total_correct<span class="token punctuation">,</span>epoch<span class="token punctuation">)</span>
    tb<span class="token punctuation">.</span>add_scalar<span class="token punctuation">(</span><span class="token string">'Accuracy'</span><span class="token punctuation">,</span>total_correct<span class="token operator">/</span>len<span class="token punctuation">(</span>train_set<span class="token punctuation">)</span><span class="token punctuation">,</span>epoch<span class="token punctuation">)</span>

    tb<span class="token punctuation">.</span>add_histogram<span class="token punctuation">(</span><span class="token string">'conv1.bias'</span><span class="token punctuation">,</span>network<span class="token punctuation">.</span>conv1<span class="token punctuation">.</span>bias<span class="token punctuation">,</span>epoch<span class="token punctuation">)</span>
    tb<span class="token punctuation">.</span>add_histogram<span class="token punctuation">(</span><span class="token string">'conv1.weight'</span><span class="token punctuation">,</span>network<span class="token punctuation">.</span>conv1<span class="token punctuation">.</span>weight<span class="token punctuation">,</span>epoch<span class="token punctuation">)</span>
    tb<span class="token punctuation">.</span>add_histogram<span class="token punctuation">(</span><span class="token string">'conv1.weight.grad'</span><span class="token punctuation">,</span>network<span class="token punctuation">.</span>conv1<span class="token punctuation">.</span>weight<span class="token punctuation">.</span>grad<span class="token punctuation">,</span>epoch<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># print(network.conv1.weight.size())</span>
    <span class="token comment" spellcheck="true"># print(network.conv1.weight.grad.size())</span>
    <span class="token comment" spellcheck="true"># print(network.fc1.weight.grad.size())</span>


    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"epoch: "</span><span class="token punctuation">,</span>epoch<span class="token punctuation">,</span>
          <span class="token string">"total_loss: "</span><span class="token punctuation">,</span>total_loss<span class="token punctuation">,</span>
          <span class="token string">"total_correct: "</span><span class="token punctuation">,</span>total_correct<span class="token punctuation">)</span>

tb<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>权重说明：<br>network.conv1.weight.size()为<code>（6*1*5*5）</code>，输入为1channel，输出为6channels， 所以为<code>6*1</code>，kernel大小为5，所以为<code>5*5</code>. 相应地，network.conv1.weight.grad.size()也为<code>（6*1*5*5）</code></p>
<p><img src="https://s2.loli.net/2022/02/13/SfraZoOHsTWjLkp.png" alt="20220213152135"></p>
<h1 id="31-Hyperparameter-Tuning-and-Experimenting-Training-Deep-Neural-Networks"><a href="#31-Hyperparameter-Tuning-and-Experimenting-Training-Deep-Neural-Networks" class="headerlink" title="31. Hyperparameter Tuning and Experimenting - Training Deep Neural Networks"></a>31. Hyperparameter Tuning and Experimenting - Training Deep Neural Networks</h1><p><img src="https://i.loli.net/2020/11/11/4MAjzTZo2pwq6mB.png" alt></p>
<h1 id="32-Training-Loop-Run-Builder-Neural-Network-Experimentation-Code"><a href="#32-Training-Loop-Run-Builder-Neural-Network-Experimentation-Code" class="headerlink" title="32. Training Loop Run Builder - Neural Network Experimentation Code"></a>32. Training Loop Run Builder - Neural Network Experimentation Code</h1><p><a href="https://deeplizard.com/learn/video/NSKghk0pcco" target="_blank" rel="noopener">Using The RunBuilder Class</a></p>
<ul>
<li>build sets of parameters that define our runs.</li>
</ul>
<p>All we have to do to add additional values is to <strong>add them to the original parameter list</strong>, and if we want to add an additional type of parameter, all we have to do is add it. The new parameter and its values will <strong>automatically become available to be consumed inside the run</strong>. The string output for the run also updates as well.</p>
<p>This functionality will allow us to have greater control as we experiment with different values during training.</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> collections <span class="token keyword">import</span> OrderedDict
<span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple
<span class="token keyword">from</span> itertools <span class="token keyword">import</span> product

<span class="token keyword">class</span> <span class="token class-name">RunBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    @staticmethod
    <span class="token keyword">def</span> <span class="token function">get_runs</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">:</span>

        Run <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'Run'</span><span class="token punctuation">,</span> params<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        runs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> v <span class="token keyword">in</span> product<span class="token punctuation">(</span><span class="token operator">*</span>params<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            runs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Run<span class="token punctuation">(</span><span class="token operator">*</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> runs

<span class="token comment" spellcheck="true"># Two parameters:</span>
params <span class="token operator">=</span> OrderedDict<span class="token punctuation">(</span>
    lr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token number">01</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token number">001</span><span class="token punctuation">]</span>
    <span class="token punctuation">,</span>batch_size <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># Three parameters:</span>
params <span class="token operator">=</span> OrderedDict<span class="token punctuation">(</span>
    lr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token number">01</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token number">001</span><span class="token punctuation">]</span>
    <span class="token punctuation">,</span>batch_size <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">]</span>
    <span class="token punctuation">,</span>device <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"cuda"</span><span class="token punctuation">,</span> <span class="token string">"cpu"</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>
runs <span class="token operator">=</span> RunBuilder<span class="token punctuation">.</span>get_runs<span class="token punctuation">(</span>params<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>runs<span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># output of two parameters</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># [</span>
<span class="token comment" spellcheck="true">#     Run(lr=0.01, batch_size=1000),</span>
<span class="token comment" spellcheck="true">#     Run(lr=0.01, batch_size=10000),</span>
<span class="token comment" spellcheck="true">#     Run(lr=0.001, batch_size=1000),</span>
<span class="token comment" spellcheck="true">#     Run(lr=0.001, batch_size=10000)</span>
<span class="token comment" spellcheck="true"># ]</span>

<span class="token comment" spellcheck="true"># output of three parameters</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># [</span>
<span class="token comment" spellcheck="true">#     Run(lr=0.01, batch_size=1000, device='cuda'),</span>
<span class="token comment" spellcheck="true">#     Run(lr=0.01, batch_size=1000, device='cpu'),</span>
<span class="token comment" spellcheck="true">#     Run(lr=0.01, batch_size=10000, device='cuda'),</span>
<span class="token comment" spellcheck="true">#     Run(lr=0.01, batch_size=10000, device='cpu'),</span>
<span class="token comment" spellcheck="true">#     Run(lr=0.001, batch_size=1000, device='cuda'),</span>
<span class="token comment" spellcheck="true">#     Run(lr=0.001, batch_size=1000, device='cpu'),</span>
<span class="token comment" spellcheck="true">#     Run(lr=0.001, batch_size=10000, device='cuda'),</span>
<span class="token comment" spellcheck="true">#     Run(lr=0.001, batch_size=10000, device='cpu')</span>
<span class="token comment" spellcheck="true"># ]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://s2.loli.net/2022/02/13/pLjHo1rOilPMaek.png" alt="20220213161157"></p>
<h1 id="33-CNN-Training-Loop-Refactoring-Simultaneous-Hyperparameter-Testing"><a href="#33-CNN-Training-Loop-Refactoring-Simultaneous-Hyperparameter-Testing" class="headerlink" title="33. CNN Training Loop Refactoring - Simultaneous Hyperparameter Testing"></a>33. <a href="https://www.youtube.com/watch?v=ozpv_peZ894&list=PLZbbT5o_s2xrfNyHZsM6ufI0iZENK9xgG&index=33" target="_blank" rel="noopener">CNN Training Loop Refactoring - Simultaneous Hyperparameter Testing</a></h1><p><img src="https://s2.loli.net/2022/02/13/QekzRKdsb7qvY4F.png" alt="20220213193129"></p>
<h1 id="34-PyTorch-DataLoader-num-workers-Deep-Learning-Speed-Limit-Increase"><a href="#34-PyTorch-DataLoader-num-workers-Deep-Learning-Speed-Limit-Increase" class="headerlink" title="34. PyTorch DataLoader num_workers - Deep Learning Speed Limit Increase"></a>34. PyTorch DataLoader num_workers - Deep Learning Speed Limit Increase</h1><p>num_workers 并非越大越好。随着num_workers增加，时间先减小后增大。可以在parameters中尝试，从而确定num_workers的具体值</p>
<h1 id="35-PyTorch-on-the-GPU-Training-Neural-Networks-with-CUDA"><a href="#35-PyTorch-on-the-GPU-Training-Neural-Networks-with-CUDA" class="headerlink" title="35. PyTorch on the GPU - Training Neural Networks with CUDA"></a>35. <a href="https://www.youtube.com/watch?v=Bs1mdHZiAS8&list=PLZbbT5o_s2xrfNyHZsM6ufI0iZENK9xgG&index=35" target="_blank" rel="noopener">PyTorch on the GPU - Training Neural Networks with CUDA</a></h1><blockquote>
<p><a href="https://stackoverflow.com/questions/62907815/pytorch-what-is-the-difference-between-tensor-cuda-and-tensor-totorch-device" target="_blank" rel="noopener">PyTorch: What is the difference between tensor.cuda() and tensor.to(torch.device(“cuda:0”))?</a><br>.cuda()/.cpu() is the old, pre-0.4 way. As of 0.4, it is recommended to use .to(device) because it is more flexible<br><img src="https://s2.loli.net/2022/02/13/5m1lfFPUwY8ovXq.png" alt="20220213234656"></p>
</blockquote>
<p><img src="https://s2.loli.net/2022/02/13/lsmkr1nhFWd8LJH.png" alt="20220213232452"><br><img src="https://s2.loli.net/2022/02/13/4dkTqzvyUM7jt1E.png" alt="20220213232551"><br><img src="https://s2.loli.net/2022/02/13/Ua8TxEXNF5V6nbk.png" alt="20220213232603"></p>
<h1 id="38-PyTorch-Sequential-Models-Neural-Networks-Made-Easy"><a href="#38-PyTorch-Sequential-Models-Neural-Networks-Made-Easy" class="headerlink" title="38. PyTorch Sequential Models - Neural Networks Made Easy"></a>38. PyTorch Sequential Models - Neural Networks Made Easy</h1><p>用nn.Sequential 构建网络的三种方式</p>
<p><img src="https://s2.loli.net/2022/02/16/sJSdAqQK5xPc1yv.png" alt="20220216232511"></p>
<p><img src="https://s2.loli.net/2022/02/16/lYbj29duEZowKxB.png" alt="20220216232847"></p>
<p>build the same network using the Sequential Class</p>
<p><img src="https://s2.loli.net/2022/02/16/eli7WxyCHU1zIGc.png" alt="20220216232935"><br><img src="https://s2.loli.net/2022/02/16/oG5xEFzTjAMW1Pg.png" alt="20220216233235"><br><img src="https://s2.loli.net/2022/02/16/OiGK5qEo16Fsgpk.png" alt="20220216233347"></p>
<hr>
<h1 id="Supplement-RNN"><a href="#Supplement-RNN" class="headerlink" title="Supplement: RNN"></a>Supplement: RNN</h1><p>PyTorch Zero To All Lecture:</p>
<p><a href="https://www.youtube.com/playlist?list=PLlMkM4tgfjnJ3I-dbhO9JTw7gNty6o_2m" target="_blank" rel="noopener">Youtube Video</a><br><a href="https://github.com/hunkim/PyTorchZeroToAll" target="_blank" rel="noopener">Code</a><br><a href="https://drive.google.com/drive/folders/0B41Zbb4c8HVyUndGdGdJSXd5d3M" target="_blank" rel="noopener">Slides</a></p>
<ul>
<li>PyTorch Lecture 12: RNN1 - Basics</li>
</ul>
<p><img src="https://i.loli.net/2020/11/21/g2FetKVEsCM4fWG.png" alt><br><img src="https://i.loli.net/2020/11/21/aLB82ZmWMJ36xPe.png" alt><br><img src="https://i.loli.net/2020/11/21/Ph83JOY4cHwrlCj.png" alt><br><img src="https://i.loli.net/2020/11/21/GJsmoMIzye3lnQW.png" alt></p>

            </div>
            <hr />

            
            <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-large waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fa fa-close"></i></a>
            <h4 class="reward-title">A cup of coffee？</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            

    <div class="reprint" id="reprint-statement">
        <p class="reprint-tip">
            <i class="fa fa-exclamation-triangle"></i>&nbsp;&nbsp;
            <span>转载规则</span>
        </p>
        
            <div class="center-align">
                <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh">
                    <img alt=""
                         style="border-width:0"
                         src="https://i.creativecommons.org/l/by/4.0/88x31.png"/>
                </a>
            </div>
            <br/>
            <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text"
                  property="dct:title" rel="dct:type">
                    《Deep Learning with PyTorch-note》
                </span> 由
            <a xmlns:cc="http://creativecommons.org/ns#" href="/2020/11/01/python/ml/deep-learning-with-pytorch-note/" property="cc:attributionName"
               rel="cc:attributionURL">
                M
            </a> 采用
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh">
                知识共享署名 4.0 国际许可协议
            </a>进行许可。
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>


        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2020/11/21/study/yong-latex-he-word-xie-lun-wen/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/9.jpg" class="responsive-img" alt="用Latex和Word写论文">
                        
                        <span class="card-title">用Latex和Word写论文</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Latex转Word
打开cmd
cd 到LaTeX文件所在的路径
pandoc Manuscript.tex -o Manuscript.docx
若要把bib参考文献也转换：pandoc Manuscript.tex --bibliog
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2020-11-21
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Study/" class="post-category" target="_blank">
                                    Study
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Study/" target="_blank">
                        <span class="chip bg-color">Study</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2020/09/26/ji-suan-ji-ji-chu/kuang-shen-shuo-mysql/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/9.jpg" class="responsive-img" alt="狂神说MySQL">
                        
                        <span class="card-title">狂神说MySQL</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
Navicat 15.x for MySQL安装



MySQL （B站视频）
MySQL （文档）
MySQL01：初识MySQL
MySQL02：数据库操作
MySQL03：DML语言
MySQL04：使用DQL查询数据
MySQL
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2020-09-26
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/CS/" class="post-category" target="_blank">
                                    CS
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/MySQL/" target="_blank">
                        <span class="chip bg-color">MySQL</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: M's Blog<br />'
            + '作者: M<br />'
            + '链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () { bodyElement.removeChild(newdiv); }, 200);
    });
</script>

    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fa fa-list"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h1, h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    

</main>


<script src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\(', '\)']]}
    });
</script>

<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>
<!-- 代码语言 -->
<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>
<!-- 代码块复制 -->
<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>
<script type="text/javascript" src="/libs/codeBlock/clipboard.min.js"></script>
<!-- 代码块收缩 -->
<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script> 
<!-- 代码块折行 -->
<style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style>


    <footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            &copy; M. 版权所有

            
            &nbsp;<i class="fa fa-area-chart"></i>&nbsp;站点总字数:&nbsp;
            <span class="white-color">219.2k</span>
            

            <br>
            <span id="sitetime"></span>

            
            
            <br>
            
            <span id="busuanzi_container_site_pv" style='display:none'>
                <i class="fa fa-heart-o"></i>
                本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">


    <a href="mailto:amilyxhd@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>









    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fa fa-rss"></i>
    </a>
</div>
    </div>
</footer>

<div class="progress-bar"></div>

<!-- 不蒜子计数初始值纠正 -->
<script>
    $(document).ready(function () {

        var int = setInterval(fixCount, 50);
        var pvcountOffset = 1928;
        var uvcountOffset = 2000;

        function fixCount() {
            if (document.getElementById("busuanzi_container_site_pv").style.display != "none") {
                $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + pvcountOffset);
                clearInterval(int);
            }
            if ($("#busuanzi_container_site_pv").css("display") != "none") {
                $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + uvcountOffset); // 加上初始数据 
                clearInterval(int);
            }
        }
    });
</script>

<script language=javascript>
    function siteTime() {
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth() + 1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();
        /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
        year - 作为date对象的年份，为4位年份值
        month - 0-11之间的整数，做为date对象的月份
        day - 1-31之间的整数，做为date对象的天数
        hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
        minutes - 0-59之间的整数，做为date对象的分钟数
        seconds - 0-59之间的整数，做为date对象的秒数
        microseconds - 0-999之间的整数，做为date对象的毫秒数 */
        var t1 = Date.UTC(2020, 01, 18, 00, 00, 00); //北京时间2018-2-13 00:00:00
        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
        var diff = t2 - t1;
        var diffYears = Math.floor(diff / years);
        var diffDays = Math.floor((diff / days) - diffYears * 365);
        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);
        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds);
        document.getElementById("sitetime").innerHTML = "本站已运行 " + diffYears + " 年 " + diffDays + " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
</script>

    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <script type="text/javascript"> var OriginTitile = document.title, st; document.addEventListener("visibilitychange", function () { document.hidden ? (document.title = "O(∩_∩)O", clearTimeout(st)) : (document.title = "Hello！φ(゜▽゜*)♪", st = setTimeout(function () { document.title = OriginTitile }, 3e3)) })
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', '');
</script>



    
    <script src="/libs/others/clicklove.js"></script>
    

    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    <!-- 雪花特效 -->
    

</body>

</html>