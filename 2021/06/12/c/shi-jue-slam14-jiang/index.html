<!DOCTYPE HTML>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="视觉SLAM14讲, It&#39;s the job that&#39;s never started as takes longest to finish.”― J.R.R. Tolkien">
    <meta name="baidu-site-verification" content="fmlEuI34ir">
    <meta name="google-site-verification" content="yCy2azpds5XSuGZvis6OuA-XIGF5GuGpYRAaGfD6o48">
    <meta name="360-site-verification" content="b7c11a830ef90fd1464ad6206bb7b6e7">
    <meta name="description" content="视频讲解第一版配套代码第二版配套代码（prefer）
高翔：视觉slam是什么？坐标系，三角测量，PNPEPNP算法原理

库说明：

Eigen：几何模块
Sophus：李代数模块 （在Eigen基础上开发）
优化库
Ceres 库面向通">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>视觉SLAM14讲 | M&#39;s Blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
    <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?46e79e71af0709a5b9106bf20cecc493";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

    
        <script>
            (function(){
                var bp = document.createElement('script');
                var curProtocol = window.location.protocol.split(':')[0];
                if (curProtocol === 'https') {
                    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
                }
                else {
                    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                }
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(bp, s);
            })();
        </script>
    

    <script>
        (function(){
        var src = "https://jspassport.ssl.qhimg.com/11.0.1.js?d182b3f28525f2db83acfaaf6e696dba";
        document.write('<script src="' + src + '" id="sozz"><\/script>');
        })();
    </script>

<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body>

    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">M's Blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>标签</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>关于</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>友情链接</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/lifelog" class="waves-effect waves-light">
            
            <i class="fa fa-comments"></i>
            
            <span>Life Log</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">M's Blog</div>
        <div class="logo-desc">
            
            Growth | Study
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                标签
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                关于
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                友情链接
            </a>
        </li>
        
        <li>
            <a href="/lifelog" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-comments"></i>
                
                Life Log
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/ismxue" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/ismxue" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/9.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        视觉SLAM14讲
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                        <a href="/tags/SLAM/" target="_blank">
                            <span class="chip bg-color">SLAM</span>
                        </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                        <a href="/categories/计算机基础/" class="post-category" target="_blank">
                            计算机基础
                        </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-06-12
                </div>

                <div class="post-author info-break-policy">
                    <i class="fa fa-user-o fa-fw"></i>作者:&nbsp;&nbsp;
                    
                    M
                    
                </div>

                
                
                <div class="info-break-policy">
                    <i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp;
                    7.9k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    28 分
                </div>
                
                

                
                <div id="busuanzi_container_page_pv" class="info-break-policy">
                    <i class="fa fa-eye fa-fw"></i>热度:&nbsp;&nbsp;
                    <span id="busuanzi_value_page_pv"></span>
                </div>
                
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <p><a href="https://www.bilibili.com/video/BV16t411g7FR?p=2" target="_blank" rel="noopener">视频讲解</a><br><a href="https://github.com/gaoxiang12/slambook" target="_blank" rel="noopener">第一版配套代码</a><br><a href="https://github.com/gaoxiang12/slambook2" target="_blank" rel="noopener">第二版配套代码（prefer）</a></p>
<p><a href="https://www.cnblogs.com/gaoxiang12/tag/SLAM/" target="_blank" rel="noopener">高翔：视觉slam是什么？</a><br><a href="https://zhuanlan.zhihu.com/p/80921759" target="_blank" rel="noopener">坐标系，三角测量，PNP</a><br><a href="https://www.guyuehome.com/19581" target="_blank" rel="noopener">EPNP算法原理</a></p>
<hr>
<p>库说明：</p>
<ul>
<li>Eigen：几何模块</li>
<li>Sophus：李代数模块 （在Eigen基础上开发）</li>
<li>优化库<ul>
<li><strong>Ceres 库面向通用的最小二乘问题的求解</strong>，作为用户，我们需要做的就是定义优化问题，然后设置一些选项，输入进 Ceres 求解即可</li>
<li><strong>g2o是一个基于图优化的库</strong>（General Graphic Optimization）。为了使用 g2o，首先要做的是将问题抽象成图优化。这个过程中，只要记住<strong>节点为优化变量，边为误差项</strong>即可</li>
</ul>
</li>
</ul>
<hr>
<h1 id="第二讲"><a href="#第二讲" class="headerlink" title="第二讲"></a>第二讲</h1><p><img src="https://i.loli.net/2021/06/12/hZgJuHXpct9QoDi.png" alt><br>我们把整个视觉 SLAM 流程分为以下几步：</p>
<ol>
<li>传感器信息读取。在视觉 SLAM 中主要为相机图像信息的读取和预处理。如果在机<br>器人中，还可能有码盘、惯性传感器等信息的读取和同步。</li>
<li><strong>视觉里程计</strong> (Visual Odometry, VO)。视觉里程计任务是估算相邻图像间相机的运动，<br>以及局部地图的样子。<em><em> VO 又称为前端（Front End）</em></em>。<ul>
<li>视觉里程计关心相邻图像之间的相机运动，最简单的情况当然是两张图像之间的运动<br>关系</li>
</ul>
</li>
<li><strong>后端优化</strong>（Optimization）。后端接受不同时刻视觉里程计测量的相机位姿，以及回<br>环检测的信息，对它们进行优化，得到全局一致的轨迹和地图。由于接在 VO 之后，<br>又称为后端（Back End）。<ul>
<li>笼统地说，后端优化主要指处理 SLAM 过程中噪声的问题。后端优化要考虑的问题，<br>就是如何从这些带有噪声的数据中，估计整个系统的状态，以及这个状态估计的不确定性<br>有多大——这称为最大后验概率估计（Maximum-a-Posteriori， MAP）。这里的状态既包括<br>机器人自身的轨迹，也包含地图<blockquote>
<p>在视觉 SLAM 中，前端和计算机视觉研究领域更为相关，比如图像的特征提取与匹配等，后端则主要是滤波与非线性优化算法。</p>
</blockquote>
</li>
</ul>
</li>
<li><strong>回环检测</strong>（Loop Closing）。回环检测判断机器人是否曾经到达过先前的位置。如果<br>检测到回环，它会把信息提供给后端进行处理。</li>
<li><strong>建图</strong>（Mapping）。它根据估计的轨迹，建立与任务要求对应的地图</li>
</ol>
<h2 id="使用库"><a href="#使用库" class="headerlink" title="使用库"></a>使用库</h2><ul>
<li>新建一个项目，名称为P1</li>
<li>在P1中新建一个类，名称为libSLAM<ul>
<li>在libSLAM.h 中，声明printSLAM函数</li>
</ul>
</li>
</ul>
<pre><code>```cpp
#ifndef P1_LIBSLAM_H
#define P1_LIBSLAM_H


class libSLAM {
public:
    void printSLAM();
};

#endif //P1_LIBSLAM_H
```</code></pre><ul>
<li><p>在libSLAM.cpp 中，实现printSLAM函数</p>
<pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"libSLAM.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span>  std<span class="token punctuation">;</span>

<span class="token keyword">void</span> libSLAM<span class="token operator">::</span><span class="token function">printSLAM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    cout<span class="token operator">&lt;&lt;</span><span class="token string">"Hello SLAM"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>在main文件的main函数（可以为任意文件名称中的任意函数，不一定为main）中，调用printSLAM</li>
</ul>
<pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"libSLAM.h"</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  libSLAM l<span class="token punctuation">;</span>
  l<span class="token punctuation">.</span><span class="token function">printSLAM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<ul>
<li>修改cMakeLists文件的内容</li>
</ul>
<pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.19</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>P1<span class="token punctuation">)</span>

<span class="token function">set</span><span class="token punctuation">(</span>CMAKE_CXX_STANDARD <span class="token number">14</span><span class="token punctuation">)</span>

# 通过main<span class="token punctuation">.</span>cpp生成可执行文件main
<span class="token function">add_executable</span><span class="token punctuation">(</span>main main<span class="token punctuation">.</span>cpp<span class="token punctuation">)</span>
# 通过libSLAM<span class="token punctuation">.</span>cpp 生成库文件useLib
<span class="token function">add_library</span><span class="token punctuation">(</span>useLib libSLAM<span class="token punctuation">.</span>cpp<span class="token punctuation">)</span>
# 将可执行文件main链接到useLib静态库文件中
<span class="token function">target_link_libraries</span><span class="token punctuation">(</span>main useLib<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><p>其中，库文件分为静态库（以.a为后缀）和共享库（以.so为后缀）。静态库每次被调用都会生成一个副本，而共享库则只有一个副本，更省空间。cMakeLists中可以分别写为：</p>
<pre class="line-numbers language-cpp"><code class="language-cpp"># <span class="token punctuation">(</span>静态库<span class="token punctuation">)</span>
# 通过libSLAM<span class="token punctuation">.</span>cpp 生成库文件useLib
<span class="token function">add_library</span><span class="token punctuation">(</span>useLib libSLAM<span class="token punctuation">.</span>cpp<span class="token punctuation">)</span>
# 将可执行文件main链接到useLib静态库文件中
<span class="token function">target_link_libraries</span><span class="token punctuation">(</span>main useLib<span class="token punctuation">)</span>
# （共享库）
# 如果想生成共享库，则使用关键字 SHARED：
<span class="token function">add_library</span><span class="token punctuation">(</span>useLib_Shared SHARED libSLAM<span class="token punctuation">.</span>cpp<span class="token punctuation">)</span>    
# 将共享库文件useLib_Shared链接到可执行文件main中
<span class="token function">target_link_libraries</span><span class="token punctuation">(</span>main useLib_Shared<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>如果只有头文件（e.g., Eigen库只有头文件），则不需要用<code>target_link_libraries</code>将程序链接到库上，但需要在cMakeLists中添加<code>include_directories(&quot;/usr/include/eigen3/&quot;)</code> </p>
<ul>
<li>（也可以写成<code>include_directories(${/usr/include/eigen3/})</code>） </li>
<li>（可通过<code>locate eigen3</code>查找相应位置）</li>
<li>可以把头文件写到文件夹下，然后在CMakeLists.txt 中将其添加进去。比如在当前文件夹-&gt;includes-&gt;math文件夹（该文件夹中有一个头文件header_math.h），则CMakeLists.txt中添加<code>include_directories (includes/math)</code>即可</li>
</ul>
</li>
<li><p><code>find_package</code>命令是cmake提供的寻找某个库的<strong>头文件</strong>与<strong>库文件</strong>的指令。如果 cmake能够找到它，就会提供头文件和库文件所在的目录的变量 (<a href="https://blog.csdn.net/zhanghm1995/article/details/105466372" target="_blank" rel="noopener">参考该链接</a>)。在 Sophus 这个例子中，就是Sophus_INCLUDE_DIRS 和 Sophus_LIBRARIES 这两个变量。根据它们，我们就能将Sophus 库引入自己的 cmake 工程了：</p>
<pre class="line-numbers language-cpp"><code class="language-cpp">  # 为使用 sophus ，需要使用 find_package 命令找到它
  <span class="token function">find_package</span><span class="token punctuation">(</span> Sophus REQUIRED <span class="token punctuation">)</span>
  # 将头文件包含进去<span class="token punctuation">,</span>  也可以写成 <span class="token function">include_directories</span><span class="token punctuation">(</span> <span class="token string">"Sophus_INCLUDE_DIRS"</span> <span class="token punctuation">)</span>  
  <span class="token function">include_directories</span><span class="token punctuation">(</span> $<span class="token punctuation">{</span>Sophus_INCLUDE_DIRS<span class="token punctuation">}</span> <span class="token punctuation">)</span>  

  <span class="token function">add_executable</span><span class="token punctuation">(</span> useSophus useSophus<span class="token punctuation">.</span>cpp <span class="token punctuation">)</span>  # useSophus 为主文件生成的执行文件 （类似于main<span class="token punctuation">.</span>cpp的地位）
  <span class="token function">target_link_libraries</span><span class="token punctuation">(</span> useSophus Sophus<span class="token operator">::</span>Sophus<span class="token punctuation">)</span> # 将库文件上链接到执行文件中<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h2 id="Quick-CMake-tutorial及配套代码"><a href="#Quick-CMake-tutorial及配套代码" class="headerlink" title="Quick CMake tutorial及配套代码"></a><a href="https://www.jetbrains.com/help/clion/quick-cmake-tutorial.html" target="_blank" rel="noopener">Quick CMake tutorial</a>及<a href="https://github.com/MarinaKalashina/CMake-Tutorial-sample" target="_blank" rel="noopener">配套代码</a></h2><h3 id="CMakeLists-txt示例1"><a href="#CMakeLists-txt示例1" class="headerlink" title="CMakeLists.txt示例1"></a>CMakeLists.txt示例1</h3><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">2.8</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>vo1<span class="token punctuation">)</span>

<span class="token function">set</span><span class="token punctuation">(</span>CMAKE_BUILD_TYPE <span class="token string">"Release"</span><span class="token punctuation">)</span>
<span class="token function">add_definitions</span><span class="token punctuation">(</span><span class="token string">"-DENABLE_SSE"</span><span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>CMAKE_CXX_FLAGS <span class="token string">"-std=c++11 -O2 ${SSE_FLAGS} -msse4"</span><span class="token punctuation">)</span>
<span class="token function">list</span><span class="token punctuation">(</span>APPEND CMAKE_MODULE_PATH $<span class="token punctuation">{</span>PROJECT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>cmake<span class="token punctuation">)</span>

<span class="token function">find_package</span><span class="token punctuation">(</span>OpenCV <span class="token number">3</span> REQUIRED<span class="token punctuation">)</span>
<span class="token function">find_package</span><span class="token punctuation">(</span>G2O REQUIRED<span class="token punctuation">)</span>
<span class="token function">find_package</span><span class="token punctuation">(</span>Sophus REQUIRED<span class="token punctuation">)</span>

<span class="token function">include_directories</span><span class="token punctuation">(</span>
        $<span class="token punctuation">{</span>OpenCV_INCLUDE_DIRS<span class="token punctuation">}</span>
        $<span class="token punctuation">{</span>G2O_INCLUDE_DIRS<span class="token punctuation">}</span>
        $<span class="token punctuation">{</span>Sophus_INCLUDE_DIRS<span class="token punctuation">}</span>
        <span class="token string">"/usr/include/eigen3/"</span>
<span class="token punctuation">)</span>

<span class="token function">add_executable</span><span class="token punctuation">(</span>orb_cv orb_cv<span class="token punctuation">.</span>cpp<span class="token punctuation">)</span>
<span class="token function">target_link_libraries</span><span class="token punctuation">(</span>orb_cv $<span class="token punctuation">{</span>OpenCV_LIBS<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">add_executable</span><span class="token punctuation">(</span>orb_self orb_self<span class="token punctuation">.</span>cpp<span class="token punctuation">)</span>
<span class="token function">target_link_libraries</span><span class="token punctuation">(</span>orb_self $<span class="token punctuation">{</span>OpenCV_LIBS<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token macro property"># add_executable( pose_estimation_2d2d pose_estimation_2d2d.cpp extra.cpp ) # use this if in OpenCV2</span>
<span class="token function">add_executable</span><span class="token punctuation">(</span>pose_estimation_2d2d pose_estimation_2d2d<span class="token punctuation">.</span>cpp<span class="token punctuation">)</span>
<span class="token function">target_link_libraries</span><span class="token punctuation">(</span>pose_estimation_2d2d $<span class="token punctuation">{</span>OpenCV_LIBS<span class="token punctuation">}</span><span class="token punctuation">)</span>

# # <span class="token function">add_executable</span><span class="token punctuation">(</span> triangulation triangulation<span class="token punctuation">.</span>cpp extra<span class="token punctuation">.</span>cpp<span class="token punctuation">)</span> # use <span class="token keyword">this</span> <span class="token keyword">if</span> in opencv2
<span class="token function">add_executable</span><span class="token punctuation">(</span>triangulation triangulation<span class="token punctuation">.</span>cpp<span class="token punctuation">)</span>
<span class="token function">target_link_libraries</span><span class="token punctuation">(</span>triangulation $<span class="token punctuation">{</span>OpenCV_LIBS<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">add_executable</span><span class="token punctuation">(</span>pose_estimation_3d2d pose_estimation_3d2d<span class="token punctuation">.</span>cpp<span class="token punctuation">)</span>
<span class="token function">target_link_libraries</span><span class="token punctuation">(</span>pose_estimation_3d2d
        g2o_core g2o_stuff
        $<span class="token punctuation">{</span>OpenCV_LIBS<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">add_executable</span><span class="token punctuation">(</span>pose_estimation_3d3d pose_estimation_3d3d<span class="token punctuation">.</span>cpp<span class="token punctuation">)</span>
<span class="token function">target_link_libraries</span><span class="token punctuation">(</span>pose_estimation_3d3d
        g2o_core g2o_stuff
        $<span class="token punctuation">{</span>OpenCV_LIBS<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="CMakeLists-txt示例2"><a href="#CMakeLists-txt示例2" class="headerlink" title="CMakeLists.txt示例2"></a>CMakeLists.txt示例2</h3><p><img src="https://i.loli.net/2021/08/08/ok3eRjEcbsWV1nu.png" alt="20210808152734"></p>
<pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.19</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>P1<span class="token punctuation">)</span>

<span class="token function">set</span><span class="token punctuation">(</span>CMAKE_CXX_STANDARD <span class="token number">14</span><span class="token punctuation">)</span>

#先建立两个可执行文件
<span class="token function">add_executable</span><span class="token punctuation">(</span>P1 main<span class="token punctuation">.</span>cpp<span class="token punctuation">)</span>
<span class="token function">add_executable</span><span class="token punctuation">(</span>P1_calc main<span class="token punctuation">.</span>cpp calc<span class="token punctuation">.</span>cpp<span class="token punctuation">)</span>

#从calc<span class="token punctuation">.</span>cpp中构建并增加静态库 （添加共享库的方式同理，关键词为SHARED）
<span class="token function">add_library</span><span class="token punctuation">(</span>stat_lib STATIC calc<span class="token punctuation">.</span>cpp<span class="token punctuation">)</span>
#将静态库连接到可执行文件中
<span class="token function">find_library</span><span class="token punctuation">(</span>SLIB stat_lib lib<span class="token punctuation">)</span>
<span class="token function">target_link_libraries</span><span class="token punctuation">(</span>P1 LINK_PUBLIC $<span class="token punctuation">{</span>SLIB<span class="token punctuation">}</span><span class="token punctuation">)</span>

# 添加自建的头文件库
<span class="token function">include_directories</span><span class="token punctuation">(</span>includes<span class="token operator">/</span>general<span class="token punctuation">)</span>

# 添加第三方的头文件或库文件，如OpenCV，Sophus等
# 为使用 sophus ，需要使用 find_package 命令找到它
<span class="token function">find_package</span><span class="token punctuation">(</span> Sophus REQUIRED <span class="token punctuation">)</span>
# 将头文件包含进去<span class="token punctuation">,</span>  也可以写成 <span class="token function">include_directories</span><span class="token punctuation">(</span> <span class="token string">"Sophus_INCLUDE_DIRS"</span> <span class="token punctuation">)</span>
<span class="token function">include_directories</span><span class="token punctuation">(</span> $<span class="token punctuation">{</span>Sophus_INCLUDE_DIRS<span class="token punctuation">}</span> <span class="token punctuation">)</span>
# 将库文件包含进去
<span class="token function">add_executable</span><span class="token punctuation">(</span>P1 main<span class="token punctuation">.</span>cpp<span class="token punctuation">)</span>
<span class="token function">target_link_libraries</span><span class="token punctuation">(</span>P1 Sophus<span class="token operator">::</span>Sophus<span class="token punctuation">)</span> # 将库文件上链接到执行文件中<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="第三讲"><a href="#第三讲" class="headerlink" title="第三讲"></a>第三讲</h1><h2 id="内积和外积"><a href="#内积和外积" class="headerlink" title="内积和外积"></a>内积和外积</h2><ul>
<li><a href="https://zhuanlan.zhihu.com/p/348308540" target="_blank" rel="noopener">向量内积外积的计算以及几何意义</a><ul>
<li>内积的结果为一个<strong>数</strong></li>
<li>内积（点乘）的几何意义包括：<ul>
<li>表征或计算两个向量之间的夹角</li>
<li>b向量在a向量方向上的投影 </li>
</ul>
</li>
<li>外积的结果为一个垂直于a，b向量所在平面的<strong>向量</strong> （法向量方向）。大小为<code>|a||b|sin&lt;a,b&gt;</code>,是两个向量张成的四边形的有向面积</li>
</ul>
</li>
<li>Eigen中几乎所有的数据都当做矩阵来处理。为使效率更高，需要指定矩阵的大小和类型</li>
</ul>
<h2 id="SO（n）和SE（n）"><a href="#SO（n）和SE（n）" class="headerlink" title="SO（n）和SE（n）"></a>SO（n）和SE（n）</h2><ul>
<li>so（n）是特殊正交群，这个集合由n维<strong>旋转</strong>空间矩阵组成</li>
<li>坐标系之间的运动由欧氏变换描述，它由<strong>平移</strong>和<strong>旋转</strong>组成。旋转可以由旋转矩阵 <code>SO(3)</code>描述，而平移直接由一个 <code>R^3</code> 向量描述。最后，如果将平移和旋转放在一个矩阵中，就形成了<strong>变换矩阵 <code>SE(3)</code></strong>。</li>
</ul>
<h2 id="旋转向量-（不紧凑）"><a href="#旋转向量-（不紧凑）" class="headerlink" title="旋转向量 （不紧凑）"></a>旋转向量 （不紧凑）</h2><blockquote>
<p>由于上述的旋转矩阵和变换矩阵相对冗余，需要用更紧凑的方式表达旋转：旋转向量。而旋转向量和旋转矩阵之间可以相互转换</p>
</blockquote>
<ul>
<li>在对坐标系进行变换时，需要经过旋转和平移<br><img src="https://i.loli.net/2021/06/12/uNb7AYLcUVH8qmE.png" alt></li>
<li>任意旋转都可以用一个<strong>旋转轴</strong>和一个<strong>旋转角</strong>来刻画。于是，我们可以使用一个向量，<strong>其方向与旋转轴一致，而长度等于旋转角</strong>。这种向量，称为旋转向量（或轴角， AxisAngle）。这种表示法只需一个<strong>三维</strong>向量即可描述旋转。同样，对于变换矩阵，我们使用一个旋转向量和一个平移向量即可表达一次变换。这时的维数正好是<strong>六维</strong>（事实上，<strong>旋转向量就是我们下章准备介绍的李代数</strong>）</li>
</ul>
<h2 id="欧拉角-（有奇异性）"><a href="#欧拉角-（有奇异性）" class="headerlink" title="欧拉角 （有奇异性）"></a>欧拉角 （有奇异性）</h2><ul>
<li>旋转向量和旋转角相对人类而言并不直观。而欧拉角提供了3个分离的转角来描述旋转，相对直观一些，但会陷入万向锁问题，使得系统丢失了一个自由度（由三次旋转变成了两次旋转），所以也很少在SLAM中直接使用欧拉角</li>
</ul>
<h2 id="四元数-（既紧凑，又没有奇异性）"><a href="#四元数-（既紧凑，又没有奇异性）" class="headerlink" title="四元数 （既紧凑，又没有奇异性）"></a>四元数 （既紧凑，又没有奇异性）</h2><ul>
<li>一个四元数有一个实部和三个虚部。用四元数可以表示旋转</li>
<li>四元数可以与旋转向量、旋转矩阵之间进行转换</li>
</ul>
<p><img src="https://i.loli.net/2021/06/26/nuQLpcyh2mZt1xU.png" alt></p>
<h2 id="代码调试"><a href="#代码调试" class="headerlink" title="代码调试"></a>代码调试</h2><ul>
<li>plotTrajectory.cpp<ul>
<li>添加集合模块头文件<code>#include &lt;Eigen/Geometry&gt;</code></li>
<li>将文件路径<code>./examples/trajectory.txt</code>改为<code>../../examples/trajectory.txt</code></li>
</ul>
</li>
<li>visualizeGeometry<ul>
<li>若报错，重新编译一次pangolin即可</li>
</ul>
</li>
</ul>
<h1 id="第四讲"><a href="#第四讲" class="headerlink" title="第四讲"></a>第四讲</h1><h2 id="李群和李代数"><a href="#李群和李代数" class="headerlink" title="李群和李代数"></a>李群和李代数</h2><ul>
<li>给定某时刻的旋转矩阵R，我们就能求得一个 ϕ，它描述了 R 在<strong>局部的导数关系</strong>。与 R 对应的 ϕ 有什么含义呢？我们说， ϕ 正是对应到 SO(3) 上的李代数 so(3)，也就是说，<strong>李代数描述了李群的局部性质</strong>；</li>
<li>其次，给定某个向量ϕ时，矩阵指数 exp(ϕ^) 如何计算？反之，给定R时，能否有相反的运算来计算ϕ？——事实上，这正是李群与李代数间的指数/对数映射</li>
</ul>
<blockquote>
<p><strong>李群  -&gt; 一些矩阵的集合</strong></p>
<ul>
<li>三维旋转矩阵构成了特殊正交群 <code>SO(3)</code>，而变换矩阵构成了特殊欧氏群 <code>SE(3)</code>：<br><img src="https://i.loli.net/2021/06/12/Ouhmi6lVYXty1AZ.png" alt></li>
<li>群（Group）是一种<strong>集合</strong>加上一种<strong>运算</strong>的代数结构。我们把集合记作 <code>A</code>，运算记作 <code>·</code>，那么群可以记作<code>G = (A; ·)</code>。<ul>
<li><strong>李群是指具有连续（光滑）性质的群</strong>。像整数群 Z 那样离散的群没有连续性质，所以不是李群。而 <code>SO(n)</code> 和<code>SE(n)</code>，它们在实数空间上是连续的。我们能够直观地想象一个刚体能够连续地在空间中运动，所以它们都是李群</li>
<li><strong>每个李群都有与之对应的李代数。李代数描述了李群的局部性质</strong>,准确地说，是单位元附近的正切空间</li>
</ul>
</li>
</ul>
</blockquote>
<blockquote>
<p><strong>李代数so（3）和李代数 se（3） -&gt; 一些向量组成的集合</strong></p>
</blockquote>
<ul>
<li><p>so（3）实际上就是由所谓的<strong>旋转向量</strong>组成的空间<br><img src="https://i.loli.net/2021/06/26/dV6FYGN4EsvUt1r.png" alt></p>
</li>
<li><p>se（3）</p>
</li>
</ul>
<p><img src="https://i.loli.net/2021/06/26/URwx5EOtr9GcCVd.png" alt></p>
<p><img src="https://i.loli.net/2021/06/26/5V7ZjvYAeiuNt4b.png" alt></p>
<h2 id="李代数求导和扰动模型"><a href="#李代数求导和扰动模型" class="headerlink" title="李代数求导和扰动模型"></a>李代数求导和扰动模型</h2><ul>
<li><p>BCH公式<br><img src="https://i.loli.net/2021/06/26/Oavcluz5FwSVZkY.png" alt></p>
</li>
<li><p>扰动</p>
</li>
</ul>
<p><img src="https://i.loli.net/2021/06/26/lh1KsubTixEvc3M.png" alt></p>
<ul>
<li>李群可通过对数映射获得它的李代数 （Sophus的使用可参考本书代码slambook2/ch4/useSophus.cpp）</li>
</ul>
<h2 id="SO3，so3，SE3和se3初始化以及相互转换关系"><a href="#SO3，so3，SE3和se3初始化以及相互转换关系" class="headerlink" title="SO3，so3，SE3和se3初始化以及相互转换关系"></a><a href="https://blog.csdn.net/u011092188/article/details/77833022" target="_blank" rel="noopener">SO3，so3，SE3和se3初始化以及相互转换关系</a></h2><p><img src="https://i.loli.net/2021/07/28/qzkt7Ev9wIyfFlx.png" alt="20210728171656"></p>
<h2 id="旋转矩阵（R），旋转向量（V）和四元数（Q）在Eigen中转换关系"><a href="#旋转矩阵（R），旋转向量（V）和四元数（Q）在Eigen中转换关系" class="headerlink" title="旋转矩阵（R），旋转向量（V）和四元数（Q）在Eigen中转换关系"></a><a href="https://blog.csdn.net/u011092188/article/details/77430988" target="_blank" rel="noopener">旋转矩阵（R），旋转向量（V）和四元数（Q）在Eigen中转换关系</a></h2><p><img src="https://i.loli.net/2021/07/28/rMAk1x7vaq9ugJ3.png" alt="20210728171757"></p>
<h1 id="第五讲"><a href="#第五讲" class="headerlink" title="第五讲"></a>第五讲</h1><ul>
<li><p><a href="https://blog.csdn.net/weixin_45532178/article/details/115418182" target="_blank" rel="noopener">Ubuntu 20.04下安装opencv3</a></p>
</li>
<li><p>根据 RGB-D 图像和相机内参，我们可以计算任何一个像素在相机坐标系下的位置。同时，根据相机位姿，又能计算这些像素在世界坐标系下的位置。如果把所有像素的空间坐标都求出来，相当于构建一张类似于地图的东西</p>
</li>
<li><p>若有多张RGB-D图像，且知道每个图像的内参（如随相机固定的参数）和外参（如相机位姿信息），则通过求出所有像素的空间信息后，可实现点云拼接</p>
</li>
<li><p>相机内参在出厂后即固定。有些厂商会告诉内参，若没告诉，用标定法即可（已非常成熟）</p>
<ul>
<li>内参的推导可参考5.1.1小节，内参数矩阵中一般包含f_x,f_y  （像素）、 c_x,c_y   （原点平移）<br><img src="https://i.loli.net/2021/06/27/GKr3647LVmRxhA8.png" alt></li>
</ul>
</li>
<li><p>相机的外参：位姿<code>R,t</code> （旋转矩阵和平移向量）</p>
</li>
</ul>
<h1 id="第六讲"><a href="#第六讲" class="headerlink" title="第六讲"></a>第六讲</h1><ul>
<li>大多现代视觉 SLAM 算法都不需要那么高成本的传感器，甚至也不需要那么昂贵的处理器来计算这些数据，这全是算法的功劳。由于在 SLAM 问题中，同一个点往往会被一个相机在不同的时间内多次观测，同一个相机在每个时刻观测到的点也不止一个。<strong>这些因素交织在一起，使我们拥有了更多的约束，最终能够较好地从噪声数据中恢复出我们需要的东西</strong></li>
<li>SLAM中经常会碰到一些<strong>非线性优化</strong>问题：由许多个误差项平方和组成的最小二乘问题。在优化该问题时，有两种主要的梯度下降方式：Gauss-Newton 和 Levenberg-Marquardt<ul>
<li>在做最优化计算时，需要提供变量的初始值（在视觉SLAM中，可用ICP，PnP等方法提供优化初始值）</li>
</ul>
</li>
<li>优化库<ul>
<li>有两个常用的优化库：google的Ceres库和基于图优化的g2o（General Graphic Optimization， G2O）库<ul>
<li><strong>Ceres 库面向通用的最小二乘问题的求解</strong>，作为用户，我们需要做的就是定义优化问题，然后设置一些选项，输入进 Ceres 求解即可</li>
<li>另一个（主要在 SLAM 领域）广为使用的优化库 <strong>g2o是一个基于图优化的库</strong>。为了使用 g2o，首先要做的是将问题抽象成图优化。这个过程中，只要记住<strong>节点为优化变量，边为误差项</strong>即可</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="第七讲"><a href="#第七讲" class="headerlink" title="第七讲"></a>第七讲</h1><h2 id="特征点"><a href="#特征点" class="headerlink" title="特征点"></a>特征点</h2><p>（基于特征点方式的视觉里程计计算法）</p>
<ul>
<li><p>特征点：在视觉里程计中，我们希望特征点<strong>在相机运动之后仍保持稳定</strong>。（如著名的 SIFT, SURF,ORB等） </p>
<ul>
<li><p>特征点由<strong>关键点</strong>（Key-point）和<strong>描述子</strong>（Descriptor）两部分组成。（比方说，当我们<br>谈论 SIFT 特征时，是指“提取 SIFT 关键点，并计算 SIFT 描述子”两件事情）。<strong>关键点是指该特征点在图像里的位置</strong>，有些特征点还具有朝向、大小等信息。<strong>描述子通常是一个向量，按照某种人为设计的方式，描述了该关键点周围像素的信息</strong>。描述子是按照“外观<br>相似的特征应该有相似的描述子”的原则设计的</p>
<ul>
<li><p>SIFT<strong>特征点</strong>：SIFT（尺度不变特征变换， Scale-Invariant Feature Transform） 当属最为经典的一种。它充分考虑了在图像变换过程中出现的光照，尺度，旋转等变化，但随之而来的是极大的计算量。由于整个 SLAM 过程中，图像特征的提取与匹配仅仅是诸多环节中的一个，所以在 SLAM 中我们_甚少使用_这种“奢侈”的图像特征</p>
</li>
<li><p>FAST<strong>关键点</strong>： FAST 关键点属于计算特别快的一种特征点（注意这里“关键点”的用词，说明它_没有描述子_）</p>
</li>
<li><p>ORB（Oriented FAST and Rotated BRIEF）<strong>特征点</strong>：ORB特征则是目前看来非常具有代表性的实时图像特征。<strong>它改进了FAST 检测子不具有方向性的问题，并采用速度极快的二进制描述子BRIEF</strong>，使整个图像特征提取的环节大大加速。提取 ORB 特征分为两个步骤：</p>
<ol>
<li><p>FAST 角点提取：找出图像中的” 角点”。相较于原版的 FAST, ORB 中计算了特征点的主方向，为后续的 BRIEF 描述子增加了旋转不变特性。</p>
<ul>
<li>针对 FAST 角点不具有方向性和尺度的弱点， <strong>ORB 添加了尺度和旋转的描述。尺度不变性由构建图像金字塔，并在金字塔的每一层上检测角点来实现。而特征的旋转是由灰度质心法（Intensity Centroid）实现的</strong><br><img src="https://i.loli.net/2021/06/14/S8rbTA2pw9omNjE.png" alt></li>
</ul>
</li>
<li><p>BRIEF 描述子：对前一步提取出特征点的周围图像区域进行描述</p>
<ul>
<li>BRIEF 是一种二进制描述子，它的描述向量由许多个 0 和 1 组成，这里的 0 和 1 编码了关键点附近两个像素（比如说 p 和 q）的大小关系：如果 p 比 q 大，则取 1，反之就取 0 （如果我们取了 128 个这样的 p; q，最后就得到 128 维由 0， 1 组成的向量。那么， p和 q 如何选取呢？在作者原始的论文中给出了若干种挑选方法，大体上都是按照某种概率分布，随机地挑选 p 和 q 的位置。 BRIEF 使用了随机选点的比较，速度非常快，而且由于使用了二进制表达，存储起来也十分方便，适用于实时的图像匹配。）</li>
<li>原始的 BRIEF 描述子不具有旋转不变性的，因此在图像发生旋转时容易丢失。而 ORB 在 FAST 特征点提取阶段计算了关键点的方向，所以可以利用方向信息，计算了旋转之后的“Steer BRIEF”特征，使 ORB 的描述子具有较好的旋转不变性</li>
</ul>
<blockquote>
<p>由于考虑到了旋转和缩放，使得 ORB 在平移、旋转、缩放的变换下仍有良好的表现。同时， FAST 和 BRIEF 的组合也非常的高效，使得 ORB 特征在实时 SLAM 中非常受欢迎</p>
</blockquote>
</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
<li><p>在提取特征点后，接下来，我们<strong>希望根据匹配的点对，估计相机的运动</strong>。这里由于相机的原理不同，情况发生了变化：</p>
<ol>
<li>当相机为单目时，我们只知道 2D 的像素坐标，因而问题是根据<strong>两组 2D 点</strong>估计运动。该问题用对极几何来解决</li>
<li>当相机为双目、 RGB-D 时，或者我们通过某种方法得到了距离信息，那问题就是根据<strong>两组 3D 点</strong>估计运动。该问题通常用 ICP 来解决</li>
<li>如果我们有 3D 点和它们在相机的投影位置，也能估计相机的运动。该问题通过<strong>PnP</strong>求解</li>
</ol>
</li>
</ul>
<h2 id="2D-2D：对极几何-（7-3节，单目相机）"><a href="#2D-2D：对极几何-（7-3节，单目相机）" class="headerlink" title="2D-2D：对极几何 （7.3节，单目相机）"></a>2D-2D：对极几何 （7.3节，单目相机）</h2><ul>
<li><p>需要&gt;=8个点对<br><img src="https://i.loli.net/2021/06/27/eyodvJ7TCj3EBNa.png" alt><br><img src="https://i.loli.net/2021/06/27/bWFU8AfRlNdSz72.png" alt></p>
</li>
<li><p><strong>基础矩阵F和本质矩阵E</strong></p>
<ul>
<li>对极约束简洁地给出了两个匹配点的空间位置关系。于是，相机位姿估计问题变为以下两步：<ol>
<li>根据配对点的像素位置，求出 E 或者 F</li>
<li>根据 E 或者 F，求出 R; t   </li>
</ol>
<ul>
<li>由于 E 和 F <strong>只相差了相机内参</strong>，而内参在 SLAM 中通常是已知的，所以实践当中  往往使用形式更简单的 <strong>E</strong>。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>单应矩阵H</strong></p>
<ul>
<li>除了基本矩阵和本质矩阵，我们还有一种称为单应矩阵（Homography） H 的东西，它描述了两个平面之间的映射关系。若场景中的特征点都落在<strong>同一平面上</strong>（比如墙，地面等），7.3 2D-2D: 对极几何则可以通过单应性来进行运动估计。这种情况在无人机携带的俯视相机，或扫地机携带的顶视相机中比较常见</li>
<li>单应性在 SLAM 中具重要意义。当特征点共面，或者相机发生纯旋转的时候，基础矩阵的自由度下降，这就出现了所谓的<strong>退化</strong>（degenerate）。现实中的数据总包含一些噪声，这时候如果我们继续使用八点法求解基础矩阵，基础矩阵多余出来的自由度将会主要由噪声决定。为了能够<strong>避免退化现象造成的影响</strong>，通常我们会同时估计基础矩阵 F 和单应矩阵H，选择<strong>重投影误差比较小</strong>的那个作为最终的运动估计矩阵</li>
</ul>
</li>
<li><p>在经过特征点匹配后，<code>slambook2/ch7/pose_estimation_2d2d.cpp</code> 文件使用匹配好的特征点来计算本质矩阵<strong>E</strong>; F 和 H，进而分解 E 得<strong>相机的位姿R; t</strong>。（<strong>从 E; F 和 H 都可以分解出运动</strong>，不过 H 需要假设特征点位于平面上，（而本实验特征点不在同一平面），所以我们这里主要用E 来分解运动。）</p>
</li>
<li><p>在单目SLAM中，仅通过单张图像无法获得像素的深度信息，但有多张图像时，可通过三角测量的方法获得像素深度<code>slambook/ch7/triangulation.cpp</code></p>
<ul>
<li>在增大平移，会导致匹配失效；而平移太小，则三角化精度不够——这就是三角化的矛盾</li>
</ul>
</li>
</ul>
<h2 id="3D-2D：PnP-（7-7节-双目或-RGB-D-相机）"><a href="#3D-2D：PnP-（7-7节-双目或-RGB-D-相机）" class="headerlink" title="3D-2D：PnP （7.7节,双目或 RGB-D 相机）"></a>3D-2D：PnP （7.7节,双目或 RGB-D 相机）</h2><ul>
<li>需要&gt;=3个点对，以及一个额外点按验证结果<br>PnP（Perspective-n-Point）</li>
</ul>
<blockquote>
<ul>
<li><p>PnP（Perspective-n-Point）是求解 3D 到 2D 点对运动的方法。它描述了当我们<strong>知道n 个 3D 空间点以及它们的投影位置时，如何估计相机所在的位姿</strong>。前面已经说了， 2D-2D的对极几何方法需要<strong>八个</strong>或八个以上的点对（以八点法为例），且存在着初始化、纯旋转和尺度的问题。然而，如果两张图像中，其中一张特征点的 3D 位置已知，那么最少只需<strong>三个</strong>点对（需要至少一个额外点验证结果）就可以估计相机运动。特征点的 3D 位置可以由三角化，或者由 RGB-D 相机的深度图确定。因此，在双目或 RGB-D 的视觉里程计中，我们可以<strong>直接使用 PnP 估计相机运动</strong>。而在单目视觉里程计中，必须先进行初始化，然后才能使用 PnP。 3D-2D 方法不需要使用对极约束，又可以在很少的匹配点中获得较好的运动估计，是最重要的一种姿态估计方法</p>
</li>
<li><p>PnP 问题有很多种求解方法，例如用三对点估计位姿的 P3P，直接线性变换（DLT），EPnP（Efcient PnP）  等等。此外，还能用非线性优化的方式，构建最小二乘问题并迭代求解，也就是万金油式的 Bundle Adjustment。我们先来看 DLT，然后再讲 Bundle Adjustment</p>
</li>
</ul>
</blockquote>
<p><img src="https://i.loli.net/2021/07/01/be7ytICYl2puAMB.png" alt></p>
<h3 id="P3P"><a href="#P3P" class="headerlink" title="P3P"></a>P3P</h3><p>P3P 需要利用给定的三个点的几何关系。它的输入数据为<strong>三对 3D-2D 匹配点</strong>。记 3D点为 A; B; C， 2D 点为 a; b; c，其中小写字母代表的点为大写字母在相机成像平面上的投影，如图 7-11 所示。此外， P3P 还需要使用<strong>一对验证点</strong>，以从可能的解出选出正确的那一个（类似于对极几何情形）。记验证点对为 D − d，相机光心为 O。请注意，我们知道的是A; B; C 在<strong>世界坐标系</strong>中的坐标，而不是在相机坐标系中的坐标。一旦 3D 点在相机坐标系下的坐标能够算出，我们就得到了 3D-3D 的对应点，把 PnP 问题转换为了 ICP 问题</p>
<ul>
<li>从 P3P 的原理上可以看出，为了求解 PnP，我们利用了三角形相似性质，求解<strong>投影点 a; b; c 在相机坐标系下的 3D 坐标</strong></li>
<li>最后把问题转换成一个 3D 到 3D 的<strong>位姿估计</strong>问题</li>
</ul>
<h3 id="Bundle-Adjustment-（可参考第九讲）"><a href="#Bundle-Adjustment-（可参考第九讲）" class="headerlink" title="Bundle Adjustment （可参考第九讲）"></a>Bundle Adjustment （可参考第九讲）</h3><p>除了使用线性方法之外，我们可以把 PnP 问题构建成一个关于重投影误差的非线性最小二乘问题。前面说的线性方法，往往是<strong>先求相机位姿，再求空间点位置</strong>，而非线性优化则是把它们都看成优化变量，放在一起优化。这是一种非常通用的求解方式，我们可以用它对 PnP 或 ICP 给出的结果进行优化。这一类<strong>把相机和三维点放在一起进行最小化的问题</strong>，统称为Bundle Adjustment。</p>
<h2 id="3D-3D-ICP-（Iterative-Closest-Point）"><a href="#3D-3D-ICP-（Iterative-Closest-Point）" class="headerlink" title="3D-3D: ICP （Iterative Closest Point）"></a>3D-3D: ICP （Iterative Closest Point）</h2><ul>
<li>根据配对好的3D点估计相机的运动（已由图像特征给定了匹配的情况下进行位姿估计的问题）<br><img src="https://i.loli.net/2021/07/01/8wrzhnPLMyXNCJD.png" alt></li>
</ul>
<blockquote>
<p>在RGB-D SLAM 中，由于一个像素的深度数据可能测量不到，所以我们可以<strong>混合</strong>着使用 PnP和 ICP 优化：对于深度已知的特征点，建模它们的 3D-3D 误差；对于深度未知的特征点，则建模 3D-2D 的重投影误差。于是，可以将所有的误差放在同一个问题中考虑，使得<br>求解更加方便</p>
</blockquote>
<blockquote>
<p>对极几何-&gt;PnP-&gt;ICP,在这个过程中我们使用了越来越多的信息（没有深度—&gt;有一个图的深度—&gt;有两个图的深<br>度），因此，在深度准确的情况下，得到的估计也将越来越准确</p>
</blockquote>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>本节介绍了基于特征点的视觉里程计中的几个重要的问题。包括：</p>
<ol>
<li>特征点是如何提取并匹配的；</li>
<li>如何通过 2D-2D 的特征点估计相机运动；</li>
<li>如何从 2D-2D 的匹配估计一个点的空间位置；</li>
<li>3D-2D 的 PnP 问题，它的线性解法和 Bundle Adjustment 解法；</li>
<li>3D-3D 的 ICP 问题，其线性解法和 Bundle Adjustment 解法</li>
</ol>
<h1 id="第八讲"><a href="#第八讲" class="headerlink" title="第八讲"></a>第八讲</h1><h2 id="直接法的引出"><a href="#直接法的引出" class="headerlink" title="直接法的引出"></a>直接法的引出</h2><p>在视觉里程计中，除了可以用特征点法，还可以用直接法</p>
<p><img src="https://i.loli.net/2021/07/01/WE6A3ulTez8xanY.png" alt></p>
<p>我们看到使用特征点确实存在一些问题。有没有什么办法能够克服这些缺点呢？我们有以下几种思路：</p>
<ul>
<li>保留特征点，但只计算关键点，不计算描述子。同时，使用<strong>光流法</strong>（Optical Flow）来跟踪特征点的运动。这样可以回避计算和匹配描述子带来的时间，但光流本身的计算需要一定时间</li>
<li>只计算关键点，不计算描述子。同时，使用<strong>直接法</strong>（Direct Method）来计算特征点在下一时刻图像的位置。这同样可以跳过描述子的计算过程，而且直接法的计算更加简单</li>
</ul>
<p>第一种方法仍然使用特征点，只是<strong>把匹配描述子替换成了光流跟踪</strong>，估计相机运动时仍使用<strong>对极几何、 PnP 或 ICP 算法</strong>。而在直接法中，我们会根据图像的<strong>像素灰度信息</strong>来计算相机运动。</p>
<p>使用特征点法估计相机运动时，我们把特征点看作固定在三维空间的不动点。根据它们在相机中的投影位置，通过<strong>最小化重投影误差</strong>（Reprojection error）来优化相机运动。在这个过程中，我们需要精确地知道空间点在两个相机中投影后的像素位置——这也就是我<br>们为何要对特征进行匹配或跟踪的理由。同时，我们也知道，计算、匹配特征需要付出大量的计算量。相对的，在直接法中，我们并不需要知道点与点之间之间的对应关系，而是通过<strong>最小化光度误差</strong>（Photometric error）来求得它们。</p>
<p><img src="https://i.loli.net/2021/07/01/XGbOKeW93Q4BUjz.png" alt="20210701172116"></p>
<h2 id="直接法的推导"><a href="#直接法的推导" class="headerlink" title="直接法的推导"></a>直接法的推导</h2><ul>
<li>我们的目标是求第一个相机到第二个相机的相对位姿变换</li>
</ul>
<p><img src="https://i.loli.net/2021/07/01/1kVX3dyScj5hTRJ.png" alt><br><img src="https://i.loli.net/2021/07/01/ItaNseiwXxZkgVF.png" alt><br><img src="https://i.loli.net/2021/07/01/Ib9lEZ57FADyOx8.png" alt></p>
<blockquote>
<p>相比于特征点法，直接法完全依靠优化来求解相机位姿。<strong>像素梯度</strong>引导着优化的方向。如果我们想要得到正确的优化结果，就必须<strong>保证大部分像素梯度能够把优化引导到正确的方向。</strong></p>
</blockquote>
<ul>
<li>原理解释（通俗易懂）</li>
</ul>
<p><img src="https://i.loli.net/2021/07/01/zTMryHQe4G2hwiF.png" alt><br><img src="https://i.loli.net/2021/07/01/AlsHz5dCI8wPTgB.png" alt><br><img src="https://i.loli.net/2021/07/01/36LgoRsVZ25XvOr.png" alt></p>
<ul>
<li>优缺点</li>
</ul>
<p><img src="https://i.loli.net/2021/07/01/uAvfnaPbcsFdo2q.png" alt="20210701185914"></p>
<hr>
<p>前端视觉里程计能给出一个短时间内的轨迹和地图，但由于不可避免的误<br>差累积，这个地图在长时间内是不准确的。所以，在视觉里程计的基础上，我们还希望构<br>建一个尺度、规模更大的优化问题，以考虑长时间内的最优轨迹和地图。不过，考虑到精<br>度与性能的平衡，实际当中存在着许多不同的做法。</p>
<hr>
<h1 id="第九讲：后端1"><a href="#第九讲：后端1" class="headerlink" title="第九讲：后端1"></a>第九讲：后端1</h1><ul>
<li>Bundle Adjustment （BA）<br>所谓的 BundleAdjustment，是指从视觉重建中提炼出最优的 <strong>3D 模型和相机参数</strong>（内参数和外参数）。<br>从每一个特征点反射出来的几束光线（bundles of light rays），在我们把<strong>相机姿态</strong>和<strong>特征点空间位置</strong>做出最优的调整 (adjustment) 之后，最后收束到相机光心的这个过程，简称为 BA。</li>
</ul>
<p><img src="https://i.loli.net/2021/07/01/EmZ8jB7RAxTtonN.png" alt><br><img src="https://i.loli.net/2021/07/01/YTZOVu6lwcznMCH.png" alt></p>
<h1 id="第十讲"><a href="#第十讲" class="headerlink" title="第十讲"></a>第十讲</h1><blockquote>
<p>SLAM的主体（前端、后端）主要的目的在于估计相机运动：前端提供特征点的提取和轨迹、地图的初值，而后端负责对所有这些数据进行优化。</p>
</blockquote>
<h1 id="第十一讲：回环检测"><a href="#第十一讲：回环检测" class="headerlink" title="第十一讲：回环检测"></a>第十一讲：回环检测</h1><ul>
<li>回环检测模块，能够给<br>出除了相邻帧之外的，一些时隔更加久远的约束：例如 x1 − x100 之间的位姿变换。为什<br>么它们之间会有约束呢？这是因为我们察觉到相机经过了同一个地方， 采集到了相似的数<br>据。而回环检测的关键，就是如何有效地检测出相机经过同一个地方这件事。如果我们能<br>够成功地检测这件事，就可以为后端的 Pose Graph 提供更多的有效数据，使之得到更好<br>的估计，特别是得到一个全局一致（Global Consistent）的估计</li>
<li>回环检测对于 SLAM 系统意义重大。它关系到我们估计的轨迹和地图在长时间下的正确性。另一方面，由于回环检测提供了<strong>当前数据与所有历史数据的关联</strong>，在跟踪算法丢失之后，我们还可以利用回环检测进行<strong>重定位</strong>。因此，回环检测对整个 SLAM 系统精度与<br>鲁棒性的提升，是非常明显的。甚至在某些时候，我们把仅有前端和局部后端的系统称为<br>VO，而把带有回环检测和全局后端的称为 SLAM</li>
</ul>
<h1 id="第十二讲：建图"><a href="#第十二讲：建图" class="headerlink" title="第十二讲：建图"></a>第十二讲：建图</h1><ul>
<li>在适用范围内， RGB-D 相机是一种更好的<br>选择。在 RGB-D 相机中可以完全通过传感器中硬<br>件测量得到，无需消耗大量的计算资源来估计它们。并且， RGB-D 的结构光或飞时原理，<br>保证了深度数据对纹理的无关性。即使面对纯色的物体，只要它能够反射光，我们就能测<br>量到它的深度。这亦是 RGB-D 传感器的一大优势。</li>
<li>利用 RGB-D 进行稠密建图是相对容易的。不过，根据地图形式不同，也存在着若干<br>种不同的主流建图方式。最直观最简单的方法，就是根据估算的相机位姿，将 RGB-D 数<br>据转化为点云（Point Cloud），然后进行拼接，最后得到一个由离散的点组成的点云地图<br>（Point Cloud Map）。在此基础上，如果我们对外观有进一步的要求，希望估计物体的表面，<br>可以使用三角网格（Mesh），面片（Surfel）进行建图。另一方面，如果希望知道地图的障<br>碍物信息并在地图上导航，亦可通过体素（Voxel）建立占据网格地图（Occupancy Map）。</li>
</ul>
<h1 id="配置ORB-SLAM2"><a href="#配置ORB-SLAM2" class="headerlink" title="配置ORB-SLAM2"></a><a href="https://www.cnblogs.com/MingruiYu/p/12286752.html" target="_blank" rel="noopener">配置ORB-SLAM2</a></h1><blockquote>
<p><a href="https://github.com/raulmur/ORB_SLAM2" target="_blank" rel="noopener">官方源码及环境配置</a><br><a href="https://www.cnblogs.com/MingruiYu/tag/ORB-SLAM2/" target="_blank" rel="noopener">ORB-SLAM2 系列博文</a></p>
</blockquote>
<ul>
<li>pangolin<br>根据官网安装required and Recommended dependencies。然后编译文件</li>
</ul>
<pre><code>cd Pangolin
mkdir build
cd build
cmake ..
make
sudo make install</code></pre><ul>
<li><a href="https://blog.csdn.net/li_wen01/article/details/71641408" target="_blank" rel="noopener">opencv3</a><ul>
<li><a href="https://www.cnblogs.com/rohens-hbg/p/12326084.html" target="_blank" rel="noopener">安装过程遇到的问题解决方案</a></li>
</ul>
</li>
</ul>
<pre><code>cd opencv-3.4.15
mkdir build
cd build
cmake ..
make
sudo make install</code></pre><ul>
<li><p>Eigen3</p>
<ul>
<li>使用<code>sudo apt-get install libeigen3-dev</code></li>
</ul>
</li>
<li><p>ORB-SLAM2</p>
<ul>
<li>报错：error: usleep is not declared this scope。其解决方法: 只需在/include/System.h文件中添加头文件#include &lt;unistd.h&gt;即可</li>
</ul>
</li>
<li><p>在ORB-SLAM2中新建文件夹DataDownload，将数据下载到该文件夹下并解压。用官网的命令行来运行程序</p>
</li>
</ul>

            </div>
            <hr />

            
            <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-large waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fa fa-close"></i></a>
            <h4 class="reward-title">A cup of coffee？</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            

    <div class="reprint" id="reprint-statement">
        <p class="reprint-tip">
            <i class="fa fa-exclamation-triangle"></i>&nbsp;&nbsp;
            <span>转载规则</span>
        </p>
        
            <div class="center-align">
                <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh">
                    <img alt=""
                         style="border-width:0"
                         src="https://i.creativecommons.org/l/by/4.0/88x31.png"/>
                </a>
            </div>
            <br/>
            <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text"
                  property="dct:title" rel="dct:type">
                    《视觉SLAM14讲》
                </span> 由
            <a xmlns:cc="http://creativecommons.org/ns#" href="/2021/06/12/c/shi-jue-slam14-jiang/" property="cc:attributionName"
               rel="cc:attributionURL">
                M
            </a> 采用
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh">
                知识共享署名 4.0 国际许可协议
            </a>进行许可。
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>


        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2021/06/14/c/cpp-jiao-cheng-bi-ji/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/8.jpg" class="responsive-img" alt="CPP教程笔记">
                        
                        <span class="card-title">CPP教程笔记</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            

菜鸟教程
安装CLion（2020版，2021版（提取码1111））及配置


基础教程函数参数默认值
默认情况下，C++ 使用传值调用来传递参数。一般来说，这意味着函数内的代码不能改变用于调用函数的参数。
当定义一个函数，可以为参数列
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2021-06-14
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/c/" class="post-category" target="_blank">
                                    c++
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/c/" target="_blank">
                        <span class="chip bg-color">c++</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/05/25/leetcode/781-sen-lin-zhong-de-tu-zi/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/14.jpg" class="responsive-img" alt="781-森林中的兔子">
                        
                        <span class="card-title">781-森林中的兔子</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            781. 森林中的兔子
报相同数字的兔子中 （如n个兔子报的数字都是m，即[m, m,  … m]）
如果n+1&lt;=m (如 [6,6]) ,则可以认为这些兔子都是同一种颜色,可以抱成一团,兔子个数为  （m+1）*（n//(m+1)
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2021-05-25
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/LeetCode/" class="post-category" target="_blank">
                                    LeetCode
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/LeetCode/" target="_blank">
                        <span class="chip bg-color">LeetCode</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: M's Blog<br />'
            + '作者: M<br />'
            + '链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () { bodyElement.removeChild(newdiv); }, 200);
    });
</script>

    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fa fa-list"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h1, h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    

</main>


<script src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\(', '\)']]}
    });
</script>

<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>
<!-- 代码语言 -->
<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>
<!-- 代码块复制 -->
<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>
<script type="text/javascript" src="/libs/codeBlock/clipboard.min.js"></script>
<!-- 代码块收缩 -->
<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script> 
<!-- 代码块折行 -->
<style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style>


    <footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            &copy; M. 版权所有

            
            &nbsp;<i class="fa fa-area-chart"></i>&nbsp;站点总字数:&nbsp;
            <span class="white-color">204.7k</span>
            

            <br>
            <span id="sitetime"></span>

            
            
            <br>
            
            <span id="busuanzi_container_site_pv" style='display:none'>
                <i class="fa fa-heart-o"></i>
                本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">


    <a href="mailto:amilyxhd@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>









    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fa fa-rss"></i>
    </a>
</div>
    </div>
</footer>

<div class="progress-bar"></div>

<!-- 不蒜子计数初始值纠正 -->
<script>
    $(document).ready(function () {

        var int = setInterval(fixCount, 50);
        var pvcountOffset = 1928;
        var uvcountOffset = 2000;

        function fixCount() {
            if (document.getElementById("busuanzi_container_site_pv").style.display != "none") {
                $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + pvcountOffset);
                clearInterval(int);
            }
            if ($("#busuanzi_container_site_pv").css("display") != "none") {
                $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + uvcountOffset); // 加上初始数据 
                clearInterval(int);
            }
        }
    });
</script>

<script language=javascript>
    function siteTime() {
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth() + 1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();
        /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
        year - 作为date对象的年份，为4位年份值
        month - 0-11之间的整数，做为date对象的月份
        day - 1-31之间的整数，做为date对象的天数
        hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
        minutes - 0-59之间的整数，做为date对象的分钟数
        seconds - 0-59之间的整数，做为date对象的秒数
        microseconds - 0-999之间的整数，做为date对象的毫秒数 */
        var t1 = Date.UTC(2020, 01, 18, 00, 00, 00); //北京时间2018-2-13 00:00:00
        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
        var diff = t2 - t1;
        var diffYears = Math.floor(diff / years);
        var diffDays = Math.floor((diff / days) - diffYears * 365);
        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);
        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds);
        document.getElementById("sitetime").innerHTML = "本站已运行 " + diffYears + " 年 " + diffDays + " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
</script>

    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <script type="text/javascript"> var OriginTitile = document.title, st; document.addEventListener("visibilitychange", function () { document.hidden ? (document.title = "O(∩_∩)O", clearTimeout(st)) : (document.title = "Hello！φ(゜▽゜*)♪", st = setTimeout(function () { document.title = OriginTitile }, 3e3)) })
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', '');
</script>



    
    <script src="/libs/others/clicklove.js"></script>
    

    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    <!-- 雪花特效 -->
    

</body>

</html>